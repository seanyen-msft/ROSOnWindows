<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Porting Cookbook - ROS on Windows</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Porting Cookbook";
    var mkdocs_page_input_path = "Porting\\Cookbook.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> ROS on Windows</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../WhatsNew.html">What's New</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Build/buildfarm.html">Build Status</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Get ROS</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/Setup.html">ROS 1</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/SetupRos2.html">ROS 2</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Using ROS</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/NewToROS.html">For new ROS Users</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started with ROS 1</span></p>
                <ul>
                    <li class="toctree-l1"><a class="" href="http://wiki.ros.org/ROS/Tutorials">Tutorials at ROS Wiki ðŸ”—</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Moveit/moveit_tutorials.html">MoveIt</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Moveit/UR3.html">Universal Robot UR3</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Turtlebot/Turtlebot3.html">TurtleBot 3</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tutorials/sick_s300/getting_started.html">SICK S300</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tutorials/ethercat/soem.html">Simple Open EtherCAT Master</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tutorials/peak/peak.html">PEAK-System&reg; PCAN&reg;-Basic</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started with ROS 2</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../ros2/nav2.html">Navigation 2</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Using Github Actions</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/GithubSetupCI.html">Continuous Integration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/GithubSetupCD.html">Continuous Delivery</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/GithubSetupCS_Windows.html">Continuous Simulation (Windows)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/GithubSetupCS_Linux.html">Continuous Simulation (Linux)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/GithubSetupCS_Windows_Nav2.html">Continuous Simulation for Navigation2 System Tests</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Using Azure Pipelines</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/AzureSetupCI.html">Continuous Integration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/AzureSetupCD.html">Continuous Delivery</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/AzureSetupCS_Windows.html">Continuous Simulation (Windows)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/AzureSetupCS_Linux.html">Continuous Simulation (Linux)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ros2/system_tests.html">Continuous Simulation for Navigation2 System Tests</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Porting Guide</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/UsingROSonWindows.html">Consuming a ROS Package</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/PortingANode.html">Porting a ROS Package</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/UsingVCPKG.html">Using a C++ Dependency</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/AddingVCPKG.html">Porting a C++ Dependency</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="Cookbook.html">Porting Cookbook</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#windows-and-linux-differences">Windows and Linux Differences</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#directory-separators">Directory Separators</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#user-directory">User directory</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#quote-handling-in-command-window">Quote handling in command window</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#paths-and-ros-commands">Paths and ROS commands</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#symbol-visibility">Symbol Visibility</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#install-library-targets-given-no-destination">install Library TARGETS given no DESTINATION!</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#all-warnings">All Warnings</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#security-warnings">Security Warnings</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#c-versioning">C++ versioning</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#__attribute____">__attribute____</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#unresolved-external">Unresolved External</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beware-of-aggressive-optimization">Beware of aggressive optimization</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#case-sensitivity">Case sensitivity</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#python">Python</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#shebang">Shebang</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#shebang-in-ros-nodes">Shebang in ROS nodes</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#shebang-in-command-line-commands">Shebang in command line commands</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#errors">Errors</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#gtest-notfound">gtest-NOTFOUND</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#syntax-error-constant-windowsh-included-before-conflicting-dependency">Syntax error: 'constant' (windows.h included before conflicting dependency)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#cause">Cause:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#example">Example:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#fix">Fix:</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#missing-symbols">Missing Symbols</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#m_pi">'M_PI'</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#warnings">Warnings</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#truncation">Truncation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#unreferenced-parameters">unreferenced parameters</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cmake_c_compiler-or-cmake_cxx_compiler-error">CMAKE_C_COMPILER or CMAKE_CXX_COMPILER error</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cause_1">Cause</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#fix_1">Fix</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cmake-tip-verbose-output">CMake Tip - verbose output</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#start-ros-on-boot">Start ROS on Boot</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">ROS at Microsoft</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../ROSAtMS/AzureVM.html">Azure VM with ROS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ROSAtMS/WinML.html">Windows ML ROS Node</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://github.com/microsoft/azure_kinect_ros_driver">Azure Kinect ROS Node ðŸ”—</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://github.com/microsoft/ros_azure_iothub">Azure IoT Hub Node ðŸ”—</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://aka.ms/ros/vscode">Visual Studio Code ROS Extension ðŸ”—</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Advanced</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Build/source.html">Source Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Advanced/Performance.html">Optimizing Performance</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://github.com/ms-iot/msix_ros">ROS on MSIX Packaging ðŸ”—</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Support</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/Troubleshooting.html">Troubleshooting</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://github.com/ms-iot/rosonwindows/issues">Create Issue</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://aka.ms/ros/support">Paid Support</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">ROS on Windows</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Porting Guide &raquo;</li>
        
      
    
    <li>Porting Cookbook</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ms-iot/rosonwindows/edit/master/docs/Porting/Cookbook.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ros-for-windows-porting-cookbook">ROS for Windows Porting Cookbook</h1>
<p>While every effort has been made to reduce the effort needed to support ROS nodes on Windows, 
there will inevitably be required changes between platforms. This cookbook is intended to collect common issues and recommended solutions.</p>
<h2 id="windows-and-linux-differences">Windows and Linux Differences</h2>
<h3 id="directory-separators">Directory Separators</h3>
<p>Windows uses backslash <code>\</code> whereas Linux uses forward slash <code>/</code>. As we encounter path processing, we've been replacing them with the Python or Boost equivelents.</p>
<h3 id="user-directory">User directory</h3>
<p>Linux has a neat shortcut for refering to the users' home directory <code>~</code>. </p>
<p>Windows uses the environment variable <code>%USERPROFILE%</code> - use this whenever you see <code>~</code> in ROS documentation.</p>
<h2 id="quote-handling-in-command-window">Quote handling in command window</h2>
<p>Cmd.exe is the command processor of command window.  Single quotes are not used at all by the cmd.exe except in batch file to enclose the command to run within a FOR /F statement.  Cmd.exe handles quoting with double quotes.  This is different from Linux that uses single quote as quote character.  As encounter quoting on Windows, please use double quote.  The following example shows using double quotes around the message contents:</p>
<pre><code class="no-highlight">rostopic pub -1 /turtle1/cmd_vel geometry_msgs/Twist -- &quot;[2.0, 0.0, 0.0]&quot; &quot;[0.0, 0.0, 1.8]&quot;
</code></pre>

<h3 id="paths-and-ros-commands">Paths and ROS commands</h3>
<p>Many ROS Commands are sensitive to the drive letter they are executed from. This manifests in problems such as rosdeps not resolving correctly. </p>
<p>To address this either:
  * Put all of your ROS workspaces on the C:\ drive
  * Link folders from your C:\ drive to your workspaces.</p>
<p>To link a folder on Windows, use the mklink to create a filesystem link from one drive to another.:</p>
<pre><code class="no-highlight">mkdir d:\workspaces
mklink c:\workspaces d:\workspaces
</code></pre>

<h3 id="symbol-visibility">Symbol Visibility</h3>
<p>Windows and Linux handle symbol visibility differently. You may encounter a build error of the form:</p>
<pre><code class="no-highlight">error C2448: '__attribute__': function-style initializer appears to be a function definition
'visibility': identifier not found
</code></pre>

<p><a href="https://gcc.gnu.org/wiki/Visibility">The GCC visibility documentation</a>&nearr; has a good article on handling the compiler differences. This includes adding a header file which uses a compiler switch to select the correct visibility macro handler.</p>
<p>Symbol Visibility also impacts binary loading. If you are finding a Nodelet that does not run or a Qt Visualizer isn't working, it may be that the hosting process can not find an expected binary export. To diagnose this on Windows, the Windows developer tools includes a program called Gflags to enable various options. One of those options is called <em>Loader Snaps</em> which enables you to detect load failures while debugging. </p>
<p>Please visit the Microsoft Documentation for more information on <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/setting-and-clearing-image-file-flags">Gflags</a> and  <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/show-loader-snaps">Loaders snaps</a>.</p>
<h3 id="install-library-targets-given-no-destination">install Library TARGETS given no DESTINATION!</h3>
<p>Windows will generate separate archives and librarys. To handle this, add an ARCHIVE destination:</p>
<pre><code class="no-highlight">install(
    TARGETS ${PROJECT_NAME}
    ARCHIVE DESTINATION ${CATKIN_PACKAGE_LIB_DESTINATION}
    LIBRARY DESTINATION ${CATKIN_PACKAGE_LIB_DESTINATION})
</code></pre>

<h3 id="all-warnings">All Warnings</h3>
<p>Warnings are good. The options for selecting warning level are different. If you add specific compiler options for warnings, please add an MSVC selection. For the Visual Studio compiler, you'll use <code>/W3</code> for warning level 3 (or <code>/W4</code> which offers more warning options). If you would like to treat warnings as errors pass <code>/WX</code>. However, these warnings would need to be corrected before the compile will succeed.</p>
<pre><code class="no-highlight">if(MSVC)
  add_compile_options(/W3 /WX)
else()
  add_compile_options(-Wall -Wextra)
endif()
</code></pre>

<p>You can disable specific warnings using <code>#pragma</code>:</p>
<pre><code class="c">#ifdef _MSC_VER
  #pragma warning(disable: 4244)
  #pragma warning(disable: 4661)
#endif
</code></pre>

<h3 id="security-warnings">Security Warnings</h3>
<p>Windows deprecates certain C APIs because they are inherently insecure. You will receive a message of the form:</p>
<pre><code class="no-highlight">warning C4996: 'xxx': This function or variable may be unsafe. Consider using xxx_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.
</code></pre>

<p>Consider using modern equivelents. If you cannot use a modern equivelent, you can add the following to your cmake files:</p>
<pre><code class="no-highlight">add_definitions(&quot;/D_CRT_SECURE_NO_WARNINGS&quot;)
add_definitions(&quot;/D_SILENCE_ALL_CXX17_DEPRECATION_WARNINGS&quot;)
</code></pre>

<h3 id="c-versioning">C++ versioning</h3>
<p>Use CMake to set the C++ version:</p>
<pre><code class="no-highlight">if(NOT CMAKE_CXX_STANDARD)
  set(CMAKE_CXX_STANDARD 11)
endif()
</code></pre>

<p>or </p>
<pre><code class="no-highlight">if(NOT CMAKE_CXX_STANDARD)
  set(CMAKE_CXX_STANDARD 17)
endif()
</code></pre>

<blockquote>
<p>NOTE: Boost 1.66 in the Melodic requires CMAKE_CSS_STANDARD 11</p>
</blockquote>
<h3 id="__attribute____"><code>__attribute____</code></h3>
<p><code>__attribute__</code> is not suppported with Microsoft compilers. You can use a macro replacement or use a cross platform convention.</p>
<h3 id="unresolved-external">Unresolved External</h3>
<p>Linux automatically exports symbols. Windows, symbols are private by default. <a href="https://cmake.org/cmake/help/v3.4/prop_tgt/WINDOWS_EXPORT_ALL_SYMBOLS.html">CMake provides a facility for this</a>.</p>
<p>In your cmake:</p>
<pre><code class="no-highlight">set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)
</code></pre>

<p>However, you may encounter a problem with static class members, i.e. global data symbols, as discussed in https://blog.kitware.com/create-dlls-on-windows-without-declspec-using-new-cmake-export-all-feature/. In this case you need to manually handle visibility of the static class members, using the <a href="https://cmake.org/cmake/help/v3.4/module/GenerateExportHeader.html"><code>GenerateExportHeader</code></a> CMake module. </p>
<p>In particular, if your static class members are contained in a library called <code>mylibrary</code>, you need to add the following lines in your CMake after the call to
<code>add_library(mylibrary ...)</code>: </p>
<pre><code>include(GenerateExportHeader)
generate_export_header(mylibrary)
target_include_directories(mylibrary PRIVATE ${CMAKE_CURRENT_BINARY_DIR})
</code></pre>

<p>The <code>generate_export_header(mylibrary)</code> call creates a file called <code>mylibrary_export.h</code>, contained in the <code>${CMAKE_CURRENT_BINARY_DIR}</code> build directory. This file contains the definition of the <code>mylibrary_EXPORT</code> macro, that you can use to modify your code as in the following: </p>
<pre><code>#include &quot;mylibrary_export.h&quot;

class myclass
{
 static MYLIBRARY_EXPORT int GlobalCounter;
â€¦
</code></pre>

<p>If this class definition is contained in a public header, you need to make sure to install the generated 
<code>mylibrary_export.h</code> together with the rest of the headers, i.e. : </p>
<pre><code>install(FILES ${CMAKE_CURRENT_BINARY_DIR}/mylibrary_export.h
        DESTINATION ${CATKIN_PACKAGE_INCLUDE_DESTINATION})
</code></pre>

<h3 id="beware-of-aggressive-optimization">Beware of aggressive optimization</h3>
<p>The Microsoft compiler will optimize agressively. This can manifest in strange ways. One instance was in turtlebot3 fake code, is a ROS_ASSERT with a function that only returns true. Nothing else executed.</p>
<h3 id="case-sensitivity">Case sensitivity</h3>
<p>Linux is case sensitive, whereas Windows is not. We are trying to locate case sensitive areas and isolate them. This manifests in odd errors like this: </p>
<pre><code class="no-highlight">RLException: multiple files named [turtlebot3_robot.launch] in package [turtlebot3_bringup]:
- C:\ws\turtlebot_ws\install\share\turtlebot3_bringup\launch\turtlebot3_robot.launch
- c:\ws\turtlebot_ws\install\share\turtlebot3_bringup\launch\turtlebot3_robot.launch
</code></pre>

<p>In this case, the ROS_PACKAGE_PATH has a lower case drive letter.</p>
<h2 id="python">Python</h2>
<h3 id="shebang">Shebang</h3>
<p>Windows does not support Shebang character sequence for automatically launching an interpreter. To support Python nodes on Windows, a few changes need to be made.</p>
<h4 id="shebang-in-ros-nodes">Shebang in ROS nodes</h4>
<p>If a ROS node uses Python, please rename the file with the .py extension.</p>
<h4 id="shebang-in-command-line-commands">Shebang in command line commands</h4>
<p>If you are producing a command line application which will be installed with Pip, please add a windows wrapper.</p>
<h2 id="errors">Errors</h2>
<h3 id="gtest-notfound">gtest-NOTFOUND</h3>
<p>This occurs when linking against gtest instead of ${GTEST_LIBRARIES}</p>
<pre><code class="no-highlight">  target_link_libraries( rtest
      ${GTEST_LIBRARIES}
      ${catkin_LIBRARIES}
  )
</code></pre>

<h3 id="syntax-error-constant-windowsh-included-before-conflicting-dependency">Syntax error: 'constant' (windows.h included before conflicting dependency)</h3>
<h4 id="cause">Cause:</h4>
<p><code>Windows.h</code> defines some macros which may conflict with variables defined in ROS packages. This causes build breaks if <code>windows.h</code> is included before a conflicting dependency.</p>
<p>The error for this may be misleading as it may not identify the specific redeclaration as the issue. </p>
<h4 id="example">Example:</h4>
<p>C:\ws_moveit\src\moveit_tutorials\doc\perception_pipeline\src\cylinder_segment.cpp</p>
<p>In this file in the <strong>MoveIt</strong> tutorials, a file which included the <code>window.h</code> header (pcl) was included before a file which included (marker.h via planning_scene_interface.h).
This is problematic because marker.h defines <code>DELETE</code> as an enum member while <code>DELETE</code> is also defined as a macro in <code>windows.h</code>.</p>
<p>In this case the build error was:</p>
<pre><code class="Batchfile">C:\opt\ros\melodic\x64\include\visualization_msgs/Marker.h(132): error C2059: syntax error: 'constant'
</code></pre>

<h4 id="fix">Fix:</h4>
<p>Include any headers which define the conflicting variable (i.e. <code>DELETE</code>) above/before any headers which include <code>windows.h</code>.</p>
<h2 id="missing-symbols">Missing Symbols</h2>
<h3 id="m_pi">'M_PI'</h3>
<p>Add the following to the top of your file:</p>
<pre><code class="C++">#define _USE_MATH_DEFINES
</code></pre>

<p>or define it in the CMakeFile.exe</p>
<h2 id="warnings">Warnings</h2>
<p>The Microsoft Visual Studio compiler has strict type checking enabled by default. Here are some common warnings.</p>
<h3 id="truncation">Truncation</h3>
<p>'=': truncation from 'double' to float
Use appropriate casts ensuring accuracy of the conversion.</p>
<h3 id="unreferenced-parameters">unreferenced parameters</h3>
<p>Either remove the variable, or reference it in a noop block</p>
<pre><code class="c++">uint8_t unused;
unused;
</code></pre>

<h2 id="cmake_c_compiler-or-cmake_cxx_compiler-error">CMAKE_C_COMPILER or CMAKE_CXX_COMPILER error</h2>
<p>When Visual Studio upgrades, it changes the path to the compilers. If you have previously built a ROS workspace, you'll see an error like this:</p>
<pre><code>CMake Error in CMakeLists.txt:
  The CMAKE_CXX_COMPILER:

    C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe
</code></pre>

<h3 id="cause_1">Cause</h3>
<p>This is caused by a stale CMake cache.</p>
<h3 id="fix_1">Fix</h3>
<p>Remove the build, devel and install directories and rebuild.</p>
<h2 id="cmake-tip-verbose-output">CMake Tip - verbose output</h2>
<p>When debugging a build failure, it is sometimes helpful to have verbose logging enabled:</p>
<pre><code>catkin_make -DCMAKE_VERBOSE_MAKEFILE=ON
</code></pre>

<h2 id="start-ros-on-boot">Start ROS on Boot</h2>
<p>Once you are done developing your robot and want it to automatically start on boot, you'll want to use the <a href="https://docs.microsoft.com/en-us/windows/win32/taskschd">Windows Task Scheduler</a> to start the task.</p>
<ul>
<li>Create a Windows command file, which includes the ROS environment and Install environment,</li>
</ul>
<p><code>c:\catkin_ws\start_ros.bat</code></p>
<pre><code class="Batchfile">call c:\opt\ros\melodic\x64\setup.bat
call c:\catkin_ws\install\setup.bat
roslaunch &lt;package&gt; &lt;launch file&gt;
</code></pre>

<ul>
<li>Use the command <a href="https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks">Schtasks</a>, to add a task which calls this script:</li>
</ul>
<pre><code class="Batchfile">schtasks /Create /RU &lt;User&gt; /RP &lt;password&gt; /SC ONLOGON /TN ROS /TR &quot;c:\catkin_ws\start_ros.bat&quot;
</code></pre>

<ul>
<li>Enable Windows Auto logon
Use the <a href="https://support.microsoft.com/en-us/help/324737/how-to-turn-on-automatic-logon-in-windows">Autologon documentation at Microsoft's Support website</a> to conigure autologon.</li>
</ul>
<p>Alternatively use the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autologon">Autologon Sysinternals tool</a> to configure autologon from the command line.</p>
<p>The next time the system starts, the ROS task will run.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ROSAtMS/AzureVM.html" class="btn btn-neutral float-right" title="Azure VM with ROS">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../GettingStarted/AddingVCPKG.html" class="btn btn-neutral" title="Porting a C++ Dependency"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ms-iot/rosonwindows/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../GettingStarted/AddingVCPKG.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ROSAtMS/AzureVM.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
